{% extends 'base.html' %}

{% block title %}{{ job.title }} Application{% endblock %}
{% block stylesheets %}
{% endblock %}

{% block content %}
    <h1>{{ job.title }} Application</h1>

    <p><a href="{% url wwu_housing.jobs.desk_attendant.views.admin %}">Back to list view</a></p>

    <p><strong>Applicant Name:</strong> {{ applicant_name }}</p>
    <p><strong>Email Address:</strong> {{ application.applicant.user.email }}
    {% if application.end_datetime %}
        <p>Application completed on {{ application.end_datetime|date:"F j, Y \a\t P" }}</p>
    {% else %}
        <p>Application is <strong>incomplete</strong>!</p>
    {% endif %}

    <h2>Availability</h2>
    {% if availability %}
        <p>
        {% if availability.on_campus %}
            Student will live on campus next year
            {% if availability.on_campus_where %}
                ({{ availability.on_campus_where }}).
            {% else %}
                (Unknown Location).
            {% endif %}
        {% else %}
            Student will not live on campus next year.
        {% endif %}
        <br />
        Student will be available {{ availability.hours_available }} hours.<br />
        Student {{ availability.work_study|yesno:"is,is not, might be" }} elligible for work study.<br />
        Student {{ availability.prior_desk_attendant|yesno:"was, was not" }} a Desk Attendant previously.
        </p>
    {% else %}
    <p>Applicant does not have availability information.</p>
    {% endif %}

    <h2>Addresses</h2>
    {% if addresses %}
        {% for address in addresses %}
            <h3>{{ address.address_type|capfirst }}</h3>
            <p>{{ address.street_line_1 }}<br />
            {% if address.street_line_2 %}
                {{ address.street_line_2 }}<br />
            {% endif %}
            {% if address.street_line_3 %}
                {{ address.street_line_3 }}<br />
            {% endif %}
            {{ address.city}}, {{ address.district }} {{ address.zip }}
            </p>
        {% endfor %}
    {% else %}
    <p>Applicant does not have any addresses listed.</p>
    {% endif %}

    <h2>Phone Numbers</h2>
    {% if phones %}
        {% for phone in phones %}
            <p>
            {{ phone.phone_type|title }} Phone: {{ phone.phone }} 
            {% if phone.extension %}
                Ext. {{ phone.extension }}
            {% endif %}
            </p>
        {% endfor %}
    {% else %}
        <p>Applicant does not have any phone numbers listed.</p>
    {% endif %}

    <h2>References</h2>
    {% if references %}
        {% for reference in references %}
            <p>{{ reference.name }} - {{ reference.phone }}</p>
        {% endfor %}
    {% else %}
        <p>Applicant did not list any references.</p>
    {% endif %}

    <h2>Resume</h2>
    {% if resume %}
        <p><a href="{{ resume.get_resume_url }}">Download Resume</a></p>
    {% else %}
        <p>Applicant did not submit a resume</p>
    {% endif %}

    <h2>Placement Preferences</h2>
    {% if placement_preferences %}
        {% for pref in placement_preferences %}
            <p>{{ pref.rank }} - {{ pref.community }}</p>
        {% endfor %}
    {% else %}
        <p>Applicant did not list any placement preferences.</p>
    {% endif %}

    <h2>Essay Responses</h2>
    {% if essay_responses %}
        {% for response in essay_responses reversed %}
            <p><strong>{{ response.question }}</strong><br />
            {{ response.answer }}</p>
        {% endfor %}
    {% else %}
        <p>Applicant did not respond to the essay questions.</p>
    {% endif %}

    <h2>Status</h2>
    <p>The following are the statuses of this application in all other communities that have opened this application and the status of the application in your community.</p>

    <ul style="margin-top: 1em;">
    {% for community, statuses in status_by_community.items %}
        <li>{{ community }}
        {% for status in statuses %}
            {% ifnotequal status.value '0' %}
                <ul>
                {% ifequal status.name 'process_status' %}
                    <li>Application Status: {{ status.value }}</li>
                {% endifequal %}
                {% ifequal status.name 'hours_hired_for' %}
                    <li>Hired for {{ status.value }} hour{{ status.value|pluralize }}</li>
                {% endifequal %}
                </ul>
            {% endifnotequal %}
        {% endfor %}
        </li>
    {% endfor %}
    </ul>

    <div style="margin-top: 1em;">
        <form method="post" action="">
        <fieldset>
            <legend>Application's Status in {{ community }}</legend>
            <p>{% if process_status_form.value.errors %}<span class="errors">{{ process_status_form.value.errors }}</span>{% endif %}Process Status: {{ process_status_form.value }}</p>
            <p>{% if hours_hired_for_form.value.errors %}<span class="errors">{{ hours_hired_for_form.value.errors }}</span>{% endif %}Hours Hired For: {{ hours_hired_for_form.value }}</p>
            <p><input type="submit" value="Update Status" /></p>
        </fieldset>
        </form>
    </div>

    <p><a href="{% url wwu_housing.jobs.desk_attendant.views.admin %}">Back to list view</a></p>
{% endblock %}
